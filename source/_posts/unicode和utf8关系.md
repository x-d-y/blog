---
title: unicode和utf8关系
date: 2019-08-06 12:03:40
tags: 杂项
---
&#160;&#160;&#160;&#160;&#160;&#160;平时在不同的操做系统上操作同一个文档，有时候会发现乱码。或者在Windows上编写的python代码中含有字符串等信息，之后将该脚本拷贝到linux或者mac下运行时会报“乱码”的错误，通过在网上查询后，将文档的编码或者解码方式设置为utf-8、gbk等不同的编码方式可以解决大部分的乱码问题。平常也会经常听到类似于unicode等与文档“编码”，“码点”等相关的问题，基于以上疑问，本片文章将对unicode和utf-8做一个关系梳理。
### ASCII码
&#160;&#160;&#160;&#160;&#160;&#160;在介绍unicode和utf-8之前，先来回顾一下我们在本科学习c语言时经常遇见的ASCII码，一个ASCII码对应一个字符，不论字符是字母还是数字还是特殊符号，只要在键盘上能找到的字符，都能够在ASCII码表上找到对应的编号，到目前为止，我们所使用的ASCII码共有128个。这个标准是在1986年制定的，当然在此之前，还有不同的制定规则，只是1986年是到目前为止最后一次ASCII码规则制定。我们都知道计算机的存储最小单元为字节即Byte，一个字节由八个位(bit)组成。一个位存储一个状态，状态只有两种，是或否。通常来说我们都已“1”，“0”两种状态表示计算机的存储状态。
<!--more-->
&#160;&#160;&#160;&#160;&#160;&#160;ASCII码是用一个字节表示不同的字符，即一个字节的八位中，第一位置为0，剩下还有7位，2^7正好是128个数。可以用来表示128个字符，一个数对应一个字符。这个已经足够日常的使用了，可这是对美国人而言，英文字母26个就能表达一种语言。可是其他国家的语言并不是只有26个字母表示，有的甚至完全不同于英文的26个字母，为了表示区别，将最高位置为1，剩下空出的128个字符用于表达本国的字母。欧洲人基本都开心了，一个字节既能表示ASCLL也能表示本国语言的基础字母。但是中国人总不能用字母当拼音使用吧，以万为单位的汉子根本没有什么拼写规则，只能一个汉子对应一个码，128就算乘以100也不能表达全部的中文汉子数量。（图）所以为了统一全世界各国语言的基础字符，出现了unicode
### Unicode码
&#160;&#160;&#160;&#160;&#160;&#160;unicode码的全称为“统一码”，顾名思义就是要将所有的码都进行统一，世界各国之间不要自己搞一套自己本国字符对应的码，全部都用统一码，既不会冲突也不会表示不全。既然128个ASCII码已经编码好，而且早期的计算机技术也是美国人在发展，为世界计算机技术奠定基础，大部分计算机都支持美国人的ASCII码，为了避免与早期的计算机编码不兼容问题，unicode保留了ASCII码的128个码，在此基础上进行了大量的扩充，到目前为止已经为全球1114112个基础字符进行了编号。举例来说就是，本文中的每一个汉子每一个数字甚至字符都有一个对应的号码，就像电话号码一样，每个人都有一个对应的手机号，不重复，互不干扰。
<div align=center>
<img src="https://github.com/x-d-y/blog/blob/master/source/_posts/unicode%E5%92%8Cutf8%E5%85%B3%E7%B3%BB/unicode.jpg?raw=true" width = 200>
</div>

### UTF-32
&#160;&#160;&#160;&#160;&#160;&#160;虽然每一个基础的字符都已一个属于自己的号码，但是Unicode码个数太多，并且很多用不到多字节的字符会占用更多存储空间，使得码的应用不高效，于是出现了不同的编码方式，将Unicode码进行编码，方便传输与保存。不同的编码方式对同一个字符进行编码，码文不同。所以以GBK编码的字符使用utf-8解码就会出现错误。
&#160;&#160;&#160;&#160;&#160;&#160;utf-32编码的方式采用四个字节表示一个字符，简单粗暴的表达方式虽然可以实现Unicode码的编码，但是存在诸多的不足，首先是该编码方式会为ASCII字符也分配四个字节，不仅浪费存储空间，同时还存在大端法小端法的问题。就是将不同高地位的字节存储在不同高低的地址上。如果是大端排列方式就是将高位的字节放在抵地址处，相当于就是规定了字符排列的方向。于是对于utf-32存在两套字符编码方式：UTF-32BE和UTF-32LE。
### UTF-16
&#160;&#160;&#160;&#160;&#160;&#160;UTF-16虽然考虑到了使用变长字节表示不同的字符，在字符编号较小的时候使用字节数较小的编码方式对其进行编码。随着字符编号数量较大时采用字节数较多的编码方式节省存储空间，但同样存在大端法和小端法的问题。为了彻底解决在编解码过程中产生的编码歧义问题提出了UTF-8的编码方式
### UTF-8
&#160;&#160;&#160;&#160;&#160;&#160;
UTF-8编码方式不仅完美的解决了存储过程中存储空间浪费的问题，同时还避免了大端法、小端法造成的歧义。具体的编码方式规则如下：

- 如果字符的编号小于128，即传统的ASCII码的编码方式，使用一个字节来表示，最高位置0，表示采用ASCII码的编码方式，用剩余的7位表示128个字符
- 对于需要使用大于一个字节才能表示的字符，首先判断该字符需要几个字节才能表示，确定好需要的字节数后，在第一个字节的开头用1表示，并且用到n个字节就在1后面添加n-1个1，在最后一个1后面用0表示结束，第一个字节的剩余未使用的位使用正常的编码方式，后面的每一个字节都以10开头，剩余的位同理用于正常的编码。

&#160;&#160;&#160;&#160;&#160;&#160;
举个例子来说，在第一种情况中，如果表示大写字母‘A’，那么它的编码方式就是“01000001”，与ASCII码保持一致，使用一个字节就能存储。
在第二种情况中，如果对汉字“马”。对应的Unicode十进制编号是39532，首先查找范围，属于(2048-65536)之间，马上定位需要三个字节才能表示，于是第一个字节开头先填三个1，接着填0，剩余的两个字节的开头分别都以10开头。表达方式为1110xxxx 10xxxxxx 10xxxxxx。所以“马”字符的编码结果为11101001 10101001 10101100 。由于 UTF-8 的处理单元为一个字节（也就是一次处理一个字节），所以处理器在处理的时候就不需要考虑这一个字节的存储是在高位还是在低位，直接拿到这个字节进行处理就行了，因为大小端是针对大于一个字节的数的存储问题而言的。(图)

&#160;&#160;&#160;&#160;&#160;&#160;
综上所述，UTF-8、UTF-16、UTF-32 都是 Unicode 的一种实现。

